{% extends 'base.html' %}
{% load static %}

{% block content %}
<main class="max-w-6xl mx-auto px-4 py-6">

  <!-- Intro Section -->
  <section class="bg-white p-6 rounded-lg shadow-md text-center mb-10">
    <h2 class="text-2xl font-semibold mb-3">Have Your Say!!</h2>
    <p class="text-base text-gray-600 mb-5">
      With all the happenings in our country, good and bad, we have created a forum where you can discuss these matters with others in your community.
    </p>
    <a href="/topics" class="inline-block">
      <button class="bg-slate-900 text-white px-5 py-2 rounded hover:bg-slate-800 transition">
        Join the Discussion
      </button>
    </a>
  </section>


  <!-- Latest News Section -->
  <section class="mb-12">
    <h2 class="text-xl font-semibold text-center mb-6">Latest News</h2>
    <div class="flex flex-wrap justify-center gap-6">
      {% for news in news_items %}
      <div class="bg-white rounded-lg shadow-md overflow-hidden w-72 flex flex-col">
        {% if news.image %}
        <img src="{{ news.image.url }}" alt="{{ news.title }}" class="w-full h-40 object-cover">
        {% else %}
        <img src="{% static 'img/default-news.jpg' %}" alt="Default news image" class="w-full h-40 object-cover">
        {% endif %}
        <div class="p-4 flex flex-col flex-grow">
          <!-- Category Title -->
          {% if news.category %}
            <p class="text-xs uppercase text-gray-500 mb-1">{{ news.category.name }}</p>
          {% endif %}

          <h5 class="text-lg font-semibold mb-2">{{ news.title|truncatechars:50 }}</h5>
          <p class="text-sm text-gray-700 mb-4">{{ news.summary|truncatewords:20 }}</p>
          <a href="{% url 'blog:news_detail' news.id %}" class="mt-auto inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition text-center text-sm">
            Read More
          </a>
        </div>
      </div>
      {% empty %}
      <p class="text-center text-gray-500">No recent news available.</p>
      {% endfor %}
    </div>
  </section>



  <!-- Most Recent Topics Section -->
  <section class="mb-12">
    <div class="w-full max-w-7xl mx-auto px-4 text-center">
      <h2 class="text-xl font-semibold mb-4">Most Recent Topics</h2>
      <div class="overflow-x-auto">
        <table class="w-full table-fixed border-collapse bg-white rounded-lg shadow">
          <thead class="sticky top-0 z-10">
            <tr class="bg-gray-200">
              <th class="min-w-[300px] border-b border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700">Topic Name</th>
              <th class="w-1/4 border-b border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700">Category</th>
              <th class="w-1/4 border-b border-gray-300 px-4 py-3 text-left text-sm font-semibold text-gray-700">Date Created</th>
              <th class="w-[100px] border-b border-gray-300 px-4 py-3 text-center text-sm font-semibold text-gray-700">Comments</th>
              <th class="sticky right-0 border-b border-gray-300 bg-black px-4 py-3 text-center text-sm font-semibold text-white">Go</th>
            </tr>
          </thead>
          <tbody>
            {% for topic in topics %}
            <tr class="cursor-pointer transition duration-200 hover:bg-blue-50 hover:text-blue-800"
                onclick="window.location.href='{% url 'blog:topic_detail' topic.slug %}'">
              <td class="border-b border-gray-300 px-4 py-3 text-sm text-gray-800 max-w-[250px] overflow-hidden text-ellipsis whitespace-nowrap">
                {{ topic.title }}
              </td>
              <td class="border-b border-gray-300 px-4 py-3 text-sm text-gray-800">
                {{ topic.category.name }}
              </td>
              <td class="border-b border-gray-300 px-4 py-3 text-sm text-gray-800">
                {{ topic.created_at|date:"Y/m/d" }}
              </td>
              <td class="border-b border-gray-300 px-4 py-3 text-sm text-center text-gray-800">
                {{ topic.approved_comments.count }}
              </td>
              <td class="sticky right-0 border-b border-gray-300 bg-black px-4 py-3 text-center">
                <a href="{% url 'blog:topic_detail' topic.slug %}#comments" onclick="event.stopPropagation();">
                  <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512"
                      class="mx-auto text-sm text-white" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">
                    <path d="M256 32C114.6 32 0 125.1 0 240..." />
                  </svg>
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </section>



  <!-- Most Recent Highlights Section -->
  <section class="mt-8">
    <h2 class="mb-4 text-center text-lg font-semibold">Most Recent</h2>
    <div class="space-y-4">
      {% for item in recent_items %}
      <div class="flex flex-col justify-between rounded-md bg-white p-3 shadow transition-shadow duration-300 hover:shadow-sm sm:flex-row sm:items-center">
        <div class="flex-1">
          <h4 class="text-sm font-medium">{{ item.title }}</h4>
          <hr class="my-2 border-gray-300">
          <p class="text-xs uppercase text-gray-500">{{ item.category }}</p>
        </div>
        <div class="mt-2 sm:ml-3 sm:mt-0">
          <a href="{{ item.link }}" class="text-sm font-semibold text-blue-600 hover:text-blue-800">Read More</a>
        </div>
      </div>
      {% empty %}
      <p class="text-center text-sm text-gray-500">No recent items available.</p>
      {% endfor %}
    </div>
  </section>





</main>
{% endblock %}
